#summary External Command Tuner for Linux and SageTV
#labels SageTV,Featured

This plugin is an irtunerplugin and is allows you to control your STB channel changes using an external program.

=Installation=
Download and unzip the contents to the SageTV server location.  The ExtTunerPlugin.so should automatically be extracted to the irtunerplugins/ dir.

A file, ext-command-tuner-remotes.cfg, will be placed in the root of the SageTV server.  This configuration file is where you configure the remote for your STB.

The configuration file can have more than one remote configured.  A configuraration entry for a remote has 3 fields, separated by a comma.  For example,
{{{
Remote 1, /usr/bin/irsend SEND_ONCE dish1 %s, dish-301-remote-keys.txt
}}}

Field1 is the name, ie, Remote 1, and it can be any name you want.

Field2 is the command to be executed to change the channel. %s will be replaced by the channel #.  If MacroTune is enabled, then the channel # will the complete channel #, otherwise it is simply the channel digit.

Field3 is an optional file that contains the keys for the remote.

=MacroTune=
SageTV can tune channels by issuing a single digit at a time, or by sending the complete channel at once.  When the complete channel is sent it is called MacroTune.  Depending on the script you are using to change channels, you may want your script to be called once for each channel digit, or you may want to pass the complete channel digits to the script at once.

You can enable MacroTune in the configuration by setting the following in the configuration file.
{{{
set MacroTune true
}}}

When MacroTune is enabled, the entire channel will be sent to your external command.  ie, if you tune to channel 543, then 543 will be passed to your script.  If you want the digits passed to your script as single digits, ie, 5 4 3, then you can set the following in the configuration.
{{{
set MacroTuneSepChar 32
}}}

The MacroTuneSepChar is an ascii value of the character that you want to use to separate the digits.  32 is the ascii value for a space.

So with MacroTune enabled, and a MacroTuneSepChar of 32, then your command will recieve the channel as 5 4 3, ie,
/usr/bin/irsend SEND_ONCE dish1 5 4 3

= External Command and Lirc =
I use the external command tuner plugin with lirc to control a STB.  I use the external command tuner because it's easier for me control the commands that i send to the STB using irsend.  For example, my remote line look like this,
{{{
6141, /usr/bin/irsend --count=2 SEND_ONCE dish1 select %s select, dish-301-remote-keys.txt
}}}

My Remote is called 6141, because that's what I named it since my STB is a Bell 6141 receiver. 

My command, using irsend, sets the --count=2 because without, sometimes the receiver fails to catch all digits.  --count=2 seems to be working.

I also pass a "select" before and after the complete channel #.  I do this so that if the receiver is in the screen saver mode, then the select will force it out of the mode.  Passing select after the channel # simply forces the reciever to take the channel change immediately.

= Sample Configuration =
{{{
# enable macro tuning with space separated digits
set MacroTune true
set MacroTuneSepChar 32

# Sage Remote Display Name, Command With Args (%s will be remote code)
6141, /usr/bin/irsend --count=2 SEND_ONCE dish1 select %s select, dish-301-remote-keys.txt
#6141, /usr/bin/irsend SEND_ONCE dish1 %s, dish-301-remote-keys.txt
}}}